#!/usr/bin/env python
# -*- coding:utf-8 -*-
from os import sys, path
sys.path.append(path.dirname(path.dirname(path.abspath(__file__))))

import rpcutils
client = rpcutils.login()

if len(sys.argv) < 2:
    print 'Which service?'
    exit(1)

modules = client.call("module.exploits")["modules"]

for m in modules:
    if len(sys.argv) == 3 and not sys.argv[2].lower() in m: continue
    if sys.argv[1].lower() in m:
        print m
